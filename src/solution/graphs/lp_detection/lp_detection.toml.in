[graph]
graphconf = """
digraph lp_detection {
    node [shape=Mrecord]
    video_input[type=flowunit, flowunit=video_input, device=cpu, deviceid=0, source_url="@SOLUTION_VIDEO_DIR@/test_video_vehicle.mp4"]
    videodemuxer[type=flowunit, flowunit=video_demuxer, device=cpu, deviceid=0]
    videodecoder[type=flowunit, flowunit=video_decoder, device=cpu, deviceid=0, queue_size=16, batch_size=5, pix_fmt=rgb]
    frame_resize[type=flowunit, flowunit=resize, device=cpu, deviceid=0, queue_size=16, batch_size=5, interpolation=inter_nearest, image_height=480, image_width=800]
    car_color_transpose[type=flowunit, flowunit=packed_planar_transpose, device=cpu, deviceid=0, queue_size=16, batch_size=5]
    car_normalize[type=flowunit, flowunit=normalize, device=cpu, deviceid=0, queue_size=16, batch_size=5, standard_deviation_inverse="0.003921568627451, 0.003921568627451, 0.003921568627451"]
    car_inference[type=flowunit, flowunit=car_inference, device=cuda, deviceid=0, queue_size=16, batch_size=5]
    car_yolobox[type=flowunit, flowunit=car_yolobox, device=cpu, deviceid=0, queue_size=16, batch_size=5, image_height=1080, image_width=1920]
    expand_bbox_img[type=flowunit, flowunit=expand_bbox_img, device=cpu, deviceid=0]
    car_condition[type=flowunit, flowunit=car_condition, device=cpu, deviceid=0, queue_size=16, batch_size=1]
    split_img_bbox[type=flowunit, flowunit=split_img_bbox, device=cpu, deviceid=0, queue_size=16, batch_size=5]
    car_resize[type=flowunit, flowunit=resize, device=cpu, deviceid=0, queue_size=16, batch_size=5, interpolation=inter_nearest, image_height=416, image_width=416]
    lp_color_transpose[type=flowunit, flowunit=packed_planar_transpose, device=cpu, deviceid=0, queue_size=16, batch_size=5]
    lp_normalize[type=flowunit, flowunit=normalize, device=cpu, deviceid=0, queue_size=16, batch_size=5, standard_deviation_inverse="0.003921568627451, 0.003921568627451, 0.003921568627451"]
    lp_inference[type=flowunit, flowunit=lp_inference, device=cuda, deviceid=0, queue_size=16, batch_size=5]
    lp_yolobox[type=flowunit, flowunit=lp_yolobox, device=cpu, deviceid=0, queue_size=16, batch_size=5, image_height=1080, image_width=1920]
    collapse_bbox[type=flowunit, flowunit=collapse_bbox, device=cpu, deviceid=0]
    draw_bbox[type=flowunit, flowunit=draw_bbox, device=cpu, deviceid=0, queue_size=16, batch_size=5]
    videoencoder[type=flowunit, flowunit=video_encoder, device=cpu, deviceid=0, queue_size=16, encoder=mpeg4, default_dest_url="rtsp://localhost/test"]

    video_input:out_video_url -> videodemuxer:in_video_url
    videodemuxer:out_video_packet -> videodecoder:in_video_packet
    videodecoder:out_video_frame -> frame_resize:in_image
    videodecoder:out_video_frame -> expand_bbox_img:In_img
    videodecoder:out_video_frame -> draw_bbox:in_image
    frame_resize:out_image -> car_color_transpose:in_image
    car_color_transpose:out_image -> car_normalize:in_data
    car_normalize:out_data -> car_inference:data
    car_inference:"layer15-conv" -> car_yolobox:"layer15-conv"
    car_inference:"layer22-conv" -> car_yolobox:"layer22-conv"
    car_yolobox:Out_1 -> expand_bbox_img:In_bbox
    expand_bbox_img:Out_img -> car_condition:In_img
    expand_bbox_img:Out_bbox -> car_condition:In_bbox
    car_condition:Out_true -> split_img_bbox:In_true
    car_condition:Out_false -> collapse_bbox:input
    split_img_bbox:Out_img -> car_resize:in_image
    split_img_bbox:Out_bbox -> lp_yolobox:car_bboxes
    car_resize:out_image -> lp_color_transpose:in_image
    lp_color_transpose:out_image -> lp_normalize:in_data
    lp_normalize:out_data -> lp_inference:data
    lp_inference:"layer11-conv" -> lp_yolobox:"layer11-conv"
    lp_yolobox:Out_1 -> collapse_bbox:input
    collapse_bbox:output -> draw_bbox:in_region
    draw_bbox:out_image -> videoencoder:in_video_frame
}
\
"""
format = "graphviz"
[driver]
dir = [
"@SOLUTION_FLOWUNIT_TRAFFIC_DIR@",
]
[flow]
desc = "License plate detection for video streams"