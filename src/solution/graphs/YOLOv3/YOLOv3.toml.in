[graph]
graphconf = """
digraph YOLOv3 {
    node [shape=Mrecord]
    video_input[type=flowunit, flowunit=video_input, device=cpu, deviceid=0, source_url="@SOLUTION_VIDEO_DIR@/test_video_yolov3.mp4"]
    videodemuxer[type=flowunit, flowunit=video_demuxer, device=cpu, deviceid=0]
    videodecoder[type=flowunit, flowunit=video_decoder, device=cpu, deviceid=0, queue_size=16, batch_size=5, pix_fmt=rgb]
    frame_resize[type=flowunit, flowunit=resize, device=cpu, deviceid=0, queue_size=16, batch_size=5, interpolation=inter_nearest, image_height=608, image_width=608]
    color_transpose[type=flowunit, flowunit=packed_planar_transpose, device=cpu, deviceid=0, queue_size=16, batch=5]
    normalize[type=flowunit, flowunit=normalize, device=cpu, deviceid=0, queue_size=16, batch_size=5, standard_deviation_inverse="0.003921568627451, 0.003921568627451, 0.003921568627451"]
    yolov3_inference[type=flowunit, flowunit=yolov3_inference, device=cuda, deviceid=0, queue_size=16, batch_size=5]
    yolov3_post[type=flowunit, flowunit=yolov3_post, device=cpu, deviceid=0, queue_size=16, batch_size=5, image_height=1080, image_width=1920]
    draw_bbox[type=flowunit, flowunit=draw_bbox, device=cpu, deviceid=0, queue_size=16, batch_size=5]
    videoencoder[type=flowunit, flowunit=video_encoder, device=cpu, deviceid=0, queue_size=16, encoder=mpeg4, default_dest_url="rtsp://localhost/test"]

    video_input:out_video_url -> videodemuxer:in_video_url
    videodemuxer:out_video_packet -> videodecoder:in_video_packet
    videodecoder:out_video_frame -> frame_resize:in_image
    videodecoder:out_video_frame -> draw_bbox:in_image
    frame_resize:out_image -> color_transpose:in_image
    color_transpose:out_image -> normalize:in_data
    normalize:out_data -> yolov3_inference:data
    yolov3_inference:"layer82-conv" -> yolov3_post:"layer82-conv"
    yolov3_inference:"layer94-conv" -> yolov3_post:"layer94-conv"
    yolov3_inference:"layer106-conv" -> yolov3_post:"layer106-conv"
    yolov3_post:Out_1 -> draw_bbox:in_region
    draw_bbox:out_image -> videoencoder:in_video_frame
}
\
"""
format = "graphviz"
[driver]
dir = [
"@SOLUTION_FLOWUNIT_COMMON_DIR@",
]
[flow]
desc = "YOLOv3 detection(COCO Datasets) for video stream"
